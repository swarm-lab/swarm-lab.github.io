<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>R vs Python - Round 1</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Welcome to the Swarm Lab where we study Swarm Intelligence in natural and artificial systems.">
    <link rel="canonical" href="http://www.theswarmlab.com/blog/rvspython/2014/01/05/r-vs-python-round-1/">

    <!-- Custom CSS & Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link rel="stylesheet" href="/style.css">

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link href="http://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href="http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Google Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-2260031-8', 'auto');
        ga('send', 'pageview');

    </script>

    <!-- Favicon -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicon/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicon/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicon/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicon/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicon/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicon/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicon/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicon/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/img/favicon/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/img/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/img/favicon/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/img/favicon/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/img/favicon/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="&nbsp;"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="/img/favicon/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="/img/favicon/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="/img/favicon/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="/img/favicon/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="/img/favicon/mstile-310x310.png" />

</head>


<body id="nofront" class="index">

<!-- Navigation -->
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!--<a class="navbar-brand page-scroll" href="#page-top">Swarm Lab</a>-->
            <a class="navbar-brand page-scroll" href="/">
                <img src="/img/logos/swarmlab.png" alt=Swarm Lab style="height:250%; position: relative; top: -75%;">
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="hidden">
                    <a href="#page-top"></a>
                </li>
                <li>
                    <a class="page-scroll" href="/#about">About</a>
                </li>
                <!--<li>
                    <a class="page-scroll" href="#research">Research</a>
                </li>-->

                <li class="dropdown">
                    <a class="dropdown-toggle keep-open" data-toggle="dropdown" data-hover="dropdown" href="/#research">
                        Research<i class="fa fa-angle-down"></i></a>
                    <ul class="dropdown-menu">
                        <li><a class="page-scroll" href="/#research">Current research</a></li>
                        <li><a href="/publications">Publication list</a></li>
                        <li><a href="/media">In the media</a></li>
                    </ul>
                </li>

                <li>
                    <a class="page-scroll" href="/#teaching">Teaching</a>
                </li>
                <li>
                    <a class="page-scroll" href="/#dev">Dev</a>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle keep-open" data-toggle="dropdown" data-hover="dropdown" href="/#team">
                        Team<i class="fa fa-angle-down"></i>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="/#team">Current members</a></li>
                        <li><a href="/previous_members">Previous members</a></li>
                        <li><a href="/join">Join the lab</a></li>
                    </ul>
                </li>
                <li>
                    <a class="page-scroll" href="/#contact">Contact</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>

<section class="bg-white post">

    <div class="entry">

        <h2>R vs Python - Round 1</h2>
        <h3></h3>

        <p>Written by Simon Garnier on January 5, 2014</p>

        <hr>

        <p><strong>Text by:</strong> Simon Garnier (<a href="http://www.theswarmlab.com">www.theswarmlab.com</a> / <a href="http://twitter.com/sjmgarnier">@sjmgarnier</a>)</p>

<p><strong>R code by:</strong> Simon Garnier (<a href="http://www.theswarmlab.com">www.theswarmlab.com</a> / <a href="http://twitter.com/sjmgarnier">@sjmgarnier</a>)</p>

<p><strong>Python code by:</strong> Randy Olson (<a href="http://www.randalolson.com">www.randalolson.com</a> / <a href="http://twitter.com/randal_olson">@randal_olson</a>)</p>

<p>Document generated with <a href="http://www.rstudio.com">RStudio</a>, <a href="http://yihui.name/knitr/">knitr</a>, and <a href="http://johnmacfarlane.net/pandoc/">pandoc</a>. Python figures generated with <a href="http://ipython.org/notebook.html">iPython Notebook</a>.</p>

<hr />

<h4 id="foreword">Foreword</h4>

<p>My friend Randy Olson and I got into the habit to argue about the relative qualities of our favorite languages for data analysis and visualization. I am an enthusiastic R user (<a href="http://www.r-project.org">www.r-project.org</a>) while Randy is a fan of Python (<a href="http://www.python.org">www.python.org</a>). One thing we agree on however is that our discussions are meaningless unless we actually put R and Python to a series of tests to showcase their relative strengths and weaknesses. Essentially we will set a common goal (<em>e.g.</em>, perform a particular type of data analysis or draw a particular type of graph) and create the R and Python codes to achieve this goal. And since Randy and I are all about sharing, open source and open access, we decided to make public the results of our friendly challenges so that you can help us decide between R and Python and, hopefully, also learn something along the way.</p>

<hr />

<h4 id="todays-challenge-where-we-learn-that-hollywoods-cemetery-is-full">Today’s challenge: where we learn that Hollywood’s cemetery is full</h4>

<h5 id="introduction">1 - Introduction</h5>

<p>For this first challenge, we will use data collected by Randy for his recent post on the <a href="www.randalolson.com/2013/12/31/most-violence-packed-films/">“Top 25 most violence packed 
films” in the history of the movie industry</a>. For his post, 
Randy generated a simple horizontal barchart showing the top 25 more violent films ordered by number of on screen deaths 
per minute. In the rest of this document, we will show you how to reproduce this graph using Python and how to achieve a 
similar result with R. We will detail the different steps of the process and provide for each step the corresponding 
code. You will also find the entire codes at the end of this document.</p>

<p>And now without further ado, let’s get started!</p>

<h5 id="step-by-step-process">2 - Step by step process</h5>

<p>First thing first, let’s set up our working environment by loading some necessary libraries.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Load libraries
</span><span class="n">library</span><span class="p">(</span><span class="n">lattice</span><span class="p">)</span>        <span class="c1"># Very versatile graphics package
</span><span class="n">library</span><span class="p">(</span><span class="n">latticeExtra</span><span class="p">)</span>   <span class="err">#</span> <span class="n">Addition</span> <span class="n">to</span> <span class="n">lattice</span> <span class="n">that</span> <span class="n">makes</span> <span class="n">layering</span> <span class="n">graphs</span> <span class="n">a</span> <span class="n">breathe</span></code></pre></div>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># This starts the IPython Notebook pylab module, useful for plotting and</span>
<span class="c"># interactive scientific computing</span>
<span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="o">*</span></code></pre></div>

<p>Now let’s load the data for today’s job. The raw data were scraped by Randy (using Python) from 
<a href="http://www.MovieBodyCounts.com">www.MovieBodyCounts.com</a> and he generously provided the result of his hard work on 
FigShare at this address: <a href="http://dx.doi.org/10.6084/m9.figshare.889719">http://dx.doi.org/10.6084/m9.figshare.889719</a>.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Load data into a data frame
</span><span class="n">body.count.data</span> <span class="o">&lt;-</span> <span class="n">read.csv</span><span class="p">(</span><span class="s2">"http://files.figshare.com/1332945/film_death_counts.csv"</span><span class="p">)</span></code></pre></div>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Read the data into a pandas DataFrame</span>
<span class="n">body_count_data</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="s">"http://files.figshare.com/1332945/film_death_counts.csv"</span><span class="p">)</span></code></pre></div>

<p>For each movie, the data frame contains a column for the total number of on screen deaths (“Body_Count”) and a column for 
the duration (“Length_Minutes”). We will now create an extra column for the number of on screen deaths per minute of each 
movie (“Deaths_Per_Minute”)</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Compute on screen deaths per minute for each movie. 
</span><span class="n">body.count.data</span> <span class="o">&lt;-</span> <span class="n">within</span><span class="p">(</span><span class="n">body.count.data</span><span class="p">,</span> <span class="p">{</span> 
  <span class="n">Deaths_Per_Minute</span> <span class="o">&lt;-</span> <span class="n">Body_Count</span> <span class="o">/</span> <span class="n">Length_Minutes</span>
  <span class="n">ord</span> <span class="o">&lt;-</span> <span class="n">order</span><span class="p">(</span><span class="n">Deaths_Per_Minute</span><span class="p">,</span> <span class="n">decreasing</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>  <span class="c1"># useful later
</span><span class="p">})</span></code></pre></div>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Divide the body counts by the length of the film</span>
<span class="n">body_count_data</span><span class="p">[</span><span class="s">"Deaths_Per_Minute"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">body_count_data</span><span class="p">[</span><span class="s">"Body_Count"</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span>
                                          <span class="n">body_count_data</span><span class="p">[</span><span class="s">"Length_Minutes"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></code></pre></div>

<p>Now we will reorder the data frame by (descending) number of on screen deaths per minute, and select the top 25 most 
violent movies according to this criterion.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Reorder "body.count.data" by (descending) number of on screen deaths per minute
</span><span class="n">body.count.data</span> <span class="o">&lt;-</span> <span class="n">body.count.data</span><span class="p">[</span><span class="n">body.count.data</span><span class="o">$</span><span class="n">ord</span><span class="p">,</span> <span class="p">]</span>

<span class="c1"># Select top 25 most violent movies by number of on screen deaths per minute
</span><span class="n">body.count.data</span> <span class="o">&lt;-</span> <span class="n">body.count.data</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">25</span><span class="p">,]</span></code></pre></div>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Only keep the top 25 highest kills per minute films</span>
<span class="n">body_count_data</span> <span class="o">=</span> <span class="n">body_count_data</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s">"Deaths_Per_Minute"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)[:</span><span class="mi">25</span><span class="p">]</span>

<span class="c"># Change the order of the data so highest kills per minute films are on top in the plot</span>
<span class="n">body_count_data</span> <span class="o">=</span> <span class="n">body_count_data</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s">"Deaths_Per_Minute"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></code></pre></div>

<p>In Randy’s graph, the “y” axis shows the film title with the release date. We will now generate the full title for each 
movie following a “Movie name (year)” format, and append it to the data frame.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Combine film title and release date into a new factor column with levels
# ordered by ascending violence
</span><span class="n">body.count.data</span> <span class="o">&lt;-</span> <span class="n">within</span><span class="p">(</span><span class="n">body.count.data</span><span class="p">,</span> <span class="p">{</span>
  <span class="n">Full_Title</span> <span class="o">&lt;-</span> <span class="n">paste0</span><span class="p">(</span><span class="n">Film</span><span class="p">,</span> <span class="s2">" ("</span><span class="p">,</span> <span class="n">Year</span><span class="p">,</span> <span class="s2">")"</span><span class="p">)</span>
  <span class="n">ord</span> <span class="o">&lt;-</span> <span class="n">order</span><span class="p">(</span><span class="n">Deaths_Per_Minute</span><span class="p">,</span> <span class="n">decreasing</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
  <span class="n">Full_Title</span> <span class="o">&lt;-</span> <span class="n">ordered</span><span class="p">(</span><span class="n">Full_Title</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">Full_Title</span><span class="p">[</span><span class="n">ord</span><span class="p">])))</span>  <span class="c1"># some films are duplicated! Bad Randy!
</span><span class="p">})</span></code></pre></div>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Generate the full titles for the movies: movie name (year)</span>
<span class="n">full_title</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">film</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">body_count_data</span><span class="p">[</span><span class="s">"Film"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">body_count_data</span><span class="p">[</span><span class="s">"Year"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
  <span class="n">full_title</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">film</span> <span class="o">+</span> <span class="s">" ("</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s">")"</span><span class="p">)</span>

<span class="n">body_count_</span> <span class="n">y</span><span class="o">-</span><span class="n">axis</span> <span class="n">ticks</span> <span class="n">on</span> <span class="n">the</span> <span class="n">left</span> <span class="ow">and</span> <span class="n">x</span><span class="o">-</span><span class="n">axis</span> <span class="n">ticks</span> <span class="n">on</span> <span class="n">the</span> <span class="n">bottom</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span><span class="n">data</span><span class="p">[</span><span class="s">"Full_Title"</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">full_title</span><span class="p">)</span></code></pre></div>

<p>Now we are ready to generate the barchart. We’re going to start with the default options and then we will make this thing 
look pretty.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Generate base graph
</span><span class="n">graph</span> <span class="o">&lt;-</span> <span class="n">barchart</span><span class="p">(</span><span class="n">Full_Title</span> <span class="o">~</span> <span class="n">Deaths_Per_Minute</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">body.count.data</span><span class="p">)</span>
<span class="n">print</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span></code></pre></div>

<p><img src="/img/posts/2014-01-05-r-vs-python-round-1/R/baseGraphR.png" alt="Base R graph" class="full" /></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># plot the bars</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="c"># Plot the red horizontal bars</span>
<span class="n">rects</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">body_count_data</span><span class="p">[</span><span class="s">"Deaths_Per_Minute"</span><span class="p">])),</span>
                 <span class="n">body_count_data</span><span class="p">[</span><span class="s">"Deaths_Per_Minute"</span><span class="p">],</span>
                 <span class="n">height</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                 <span class="n">align</span><span class="o">=</span><span class="s">"center"</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="s">"#8A0707"</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="s">"none"</span><span class="p">)</span>

<span class="c"># Add the film labels to left of the bars (y-axis)</span>
<span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">body_count_data</span><span class="p">[</span><span class="s">"Full_Title"</span><span class="p">])),</span> <span class="n">body_count_data</span><span class="p">[</span><span class="s">"Full_Title"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="n">xticks</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="s">""</span><span class="p">])</span></code></pre></div>

<p><img src="/img/posts/2014-01-05-r-vs-python-round-1/Py/basePy.png" alt="Base Python graph" class="full" /></p>

<p>Ok, now let’s make this pretty. </p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Create theme
</span><span class="n">my.bloody.theme</span> <span class="o">&lt;-</span> <span class="n">within</span><span class="p">(</span><span class="n">trellis.par.get</span><span class="p">(),</span> <span class="p">{</span>    <span class="c1"># Initialize theme with default value
</span>  <span class="n">axis.line</span><span class="o">$</span><span class="n">col</span> <span class="o">&lt;-</span> <span class="n">NA</span>                             <span class="c1"># Remove axes 
</span>  <span class="n">plot.polygon</span> <span class="o">&lt;-</span> <span class="n">within</span><span class="p">(</span><span class="n">plot.polygon</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">col</span> <span class="o">&lt;-</span> <span class="s2">"#8A0606"</span>                              <span class="c1"># Set bar colors to a nice bloody red
</span>    <span class="n">border</span> <span class="o">&lt;-</span> <span class="n">NA</span>                                  <span class="c1"># Remove bars' outline
</span>  <span class="p">})</span>
  <span class="n">axis.text</span><span class="o">$</span><span class="n">cex</span> <span class="o">&lt;-</span> <span class="m">1</span>                              <span class="c1"># Default axis text size is a bit small. Make it bigger
</span>  <span class="n">layout.heights</span> <span class="o">&lt;-</span> <span class="n">within</span><span class="p">(</span><span class="n">layout.heights</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">bottom.padding</span> <span class="o">&lt;-</span> <span class="m">0</span>                           <span class="c1"># Remove bottom padding
</span>    <span class="n">axis.bottom</span> <span class="o">&lt;-</span> <span class="m">0</span>                              <span class="c1"># Remove axis padding at the bottom of the graph
</span>    <span class="n">axis.top</span> <span class="o">&lt;-</span> <span class="m">0</span>                                 <span class="c1"># Remove axis padding at the top of the graph
</span>  <span class="p">})</span>
<span class="p">})</span>

<span class="c1"># Update figure with new theme + other improvements (like a title for instance)
</span><span class="n">graph</span> <span class="o">&lt;-</span> <span class="n">update</span><span class="p">(</span>
  <span class="n">graph</span><span class="p">,</span> 
  <span class="n">main</span><span class="o">=</span><span class="s1">'25 most violence packed films by deaths per minute'</span><span class="p">,</span>    <span class="c1"># Title of the barchart
</span>  <span class="n">par.settings</span> <span class="o">=</span> <span class="n">my.bloody.theme</span><span class="p">,</span>                               <span class="c1"># Use custom theme
</span>  <span class="n">xlab</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">,</span>                                                  <span class="c1"># Remove label of x axis
</span>  <span class="n">scales</span><span class="o">=</span><span class="n">list</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">list</span><span class="p">(</span><span class="n">at</span><span class="o">=</span><span class="n">NULL</span><span class="p">)),</span>                                 <span class="c1"># Remove rest of x axis
</span>  <span class="n">xlim</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">6.7</span><span class="p">),</span>                                             <span class="c1"># Set graph limits along x axis to accomodate the additional text (requires some trial and error)
</span>  <span class="n">box.width</span><span class="o">=</span><span class="m">0.75</span><span class="p">)</span>                                               <span class="c1"># Default bar width is a bit small. Make it bigger)
</span>
<span class="n">print</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span></code></pre></div>

<p><img src="/img/posts/2014-01-05-r-vs-python-round-1/R/prettyR.png" alt="Pretty R graph" class="full" /></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Don't have any x tick labels</span>
<span class="n">xticks</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="s">""</span><span class="p">])</span>

<span class="c"># Plot styling</span>

<span class="c"># Remove the plot frame lines</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">"top"</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">"right"</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">"left"</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">"bottom"</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Color the y-axis ticks the same dark red color, and the x-axis ticks white</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">"y"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"#8A0707"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">"x"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"white"</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">"white"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">"-"</span><span class="p">)</span></code></pre></div>

<p><img src="/img/posts/2014-01-05-r-vs-python-round-1/Py/prettyPy.png" alt="Pretty Python graph" class="full" /></p>

<p>Finally, the last thing we want to add to our graph is the number of deaths per minute and the duration of each movie on 
the right of the graph.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Combine number of on screen death per minute and duration of the movies into a new character string column
</span><span class="n">body.count.data</span> <span class="o">&lt;-</span> <span class="n">within</span><span class="p">(</span><span class="n">body.count.data</span><span class="p">,</span> <span class="p">{</span>
  <span class="n">Deaths_Per_Minute_With_Length</span> <span class="o">=</span> <span class="n">paste0</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="n">body.count.data</span><span class="o">$</span><span class="n">Deaths_Per_Minute</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="m">2</span><span class="p">),</span> <span class="s2">" ("</span><span class="p">,</span> <span class="n">body.count.data</span><span class="o">$</span><span class="n">Length_Minutes</span><span class="p">,</span> <span class="s2">" mins)"</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1"># Add number of on screen deaths per minute and duration of movies at the end of each bar 
</span><span class="n">graph</span> <span class="o">&lt;-</span> <span class="n">graph</span> <span class="o">+</span> <span class="n">layer</span><span class="p">(</span><span class="n">with</span><span class="p">(</span><span class="n">body.count.data</span><span class="p">,</span> 
  <span class="n">panel.text</span><span class="p">(</span>
    <span class="n">Deaths_Per_Minute</span><span class="p">,</span>                  <span class="c1"># x position of the text
</span>    <span class="m">25</span><span class="o">:</span><span class="m">1</span><span class="p">,</span>                               <span class="c1"># y position of the text
</span>    <span class="n">pos</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span>                            <span class="c1"># Position of the text relative to the x and y position (4 = to the right)
</span>    <span class="n">Deaths_Per_Minute_With_Length</span><span class="p">)))</span>    <span class="c1"># Text to display                                     
</span>
<span class="c1"># Print graph
</span><span class="n">print</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span></code></pre></div>

<p><img src="/img/posts/2014-01-05-r-vs-python-round-1/R/rightLabelsR.png" alt="Right labels R graph" class="full" /></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># This function adds the deaths per minute label to the right of the bars</span>
<span class="k">def</span> <span class="nf">autolabel</span><span class="p">(</span><span class="n">rects</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rect</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rects</span><span class="p">):</span>
  <span class="n">width</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span>
<span class="n">label_text</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
                <span class="s">" ("</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">body_count_data</span><span class="p">[</span><span class="s">"Length_Minutes"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">" mins)"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">,</span>
         <span class="n">rect</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span>
         <span class="n">label_text</span><span class="p">,</span>
         <span class="n">ha</span><span class="o">=</span><span class="s">"left"</span><span class="p">,</span>
         <span class="n">va</span><span class="o">=</span><span class="s">"center"</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">autolabel</span><span class="p">(</span><span class="n">rects</span><span class="p">)</span></code></pre></div>

<p><img src="/img/posts/2014-01-05-r-vs-python-round-1/Py/finalPy.png" alt="Right labels R graph" class="full" /></p>

<hr />

<h4 id="r-bonus">3 - R bonus</h4>

<p>Just for fun, I decided to add to the R graph a little accessory in relation with the general theme of this data set.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Load additional libraries
</span><span class="n">library</span><span class="p">(</span><span class="n">jpeg</span><span class="p">)</span>  <span class="c1"># To read JPG images
</span><span class="n">library</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>  <span class="c1"># Graphics library with better image plotting capabilities
</span>
<span class="c1"># Download a pretty background image; mode is set to "wb" because it seems that
# Windows needs it. I don't use Windows, I can't confirm
</span><span class="n">download.file</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="s2">"http://www.theswarmlab.com/wp-content/uploads/2014/01/bloody_gun.jpg"</span><span class="p">,</span> 
              <span class="n">destfile</span> <span class="o">=</span> <span class="s2">"bloody_gun.jpg"</span><span class="p">,</span> <span class="n">quiet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s2">"wb"</span><span class="p">)</span>

<span class="c1"># Load gun image using "readJPEG" from the "jpeg" package
</span><span class="n">img</span> <span class="o">&lt;-</span> <span class="n">readJPEG</span><span class="p">(</span><span class="s2">"bloody_gun.jpg"</span><span class="p">)</span>

<span class="c1"># Add image to graph using "grid.raster" from the "grid" package
</span><span class="n">graph</span> <span class="o">&lt;-</span> <span class="n">graph</span> <span class="o">+</span> <span class="n">layer_</span><span class="p">(</span>
  <span class="n">grid.raster</span><span class="p">(</span>
    <span class="n">as.raster</span><span class="p">(</span><span class="n">img</span><span class="p">),</span>                 <span class="c1"># Image as a raster
</span>    <span class="n">x</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span>                          <span class="c1"># x location of image "Normalised Parent Coordinates"
</span>    <span class="n">y</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span>                          <span class="c1"># y location of image "Normalised Parent Coordinates"
</span>    <span class="n">height</span> <span class="o">=</span> <span class="m">0.7</span><span class="p">,</span>                   <span class="c1"># Height of the image. 1 indicates that the image height is equal to the graph height
</span>    <span class="n">just</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"right"</span><span class="p">,</span> <span class="s2">"bottom"</span><span class="p">)))</span>   <span class="c1"># Justification of the image relative to its x and y locations
</span>
<span class="c1"># Print graph
</span><span class="n">print</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span></code></pre></div>

<p><img src="/img/posts/2014-01-05-r-vs-python-round-1/R/gunR.png" alt="Gun R graph" class="full" /></p>

<hr />

<h4 id="source-code">4 - Source code</h4>

<p>R and Python source codes are available <a href="https://github.com/morpionZ/R-vs-Python/tree/master/Deadliest%20movies/code">here</a>.</p>

<p>For F# fan, <a href="http://terjetyl.ghost.io/">Terje Tyldum</a> has written his version of the code in F# 
<a href="http://terjetyl.ghost.io/f-charting-challenge/">here</a>.</p>

<p>Randy and I also recommend that you check out 
<a href="http://nbviewer.ipython.org/github/yaph/ipython-notebooks/blob/master/Exploring%20Movie%20Body%20Counts.ipynb">this post</a>
by <a href="http://ramiro.org/">Ramiro Gómez</a> (<a href="https://twitter.com/yaph">@yaph</a>) where he does a more in-depth analysis of the 
data set we used for today’s challenge.</p>



        <hr>

        <p>Categories:
            
                
                    <a href="/blog/">blog</a> &bull;
                
            
                
                    <a href="/category/rvspython/">rvspython</a> &bull;
                
            
        </p>

        <hr>

<<<<<<< HEAD:_site/blog/rvspython/2014/01/05/r-vs-python-round-1/index.html
        <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'theswarmlab';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
=======
        <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'theswarmlab';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
>>>>>>> ba8699efb578130ab0155c9c5aea221afbfd6216:_site/blog/rvspython/2014/01/05/r-vs-python-round-1/index.html
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

    </div>

</section>

<footer class="bg-darkest-gray">
    <div class="container">
        <span style="color: white">Subscribe <a href="/feed.xml">via RSS</a></span>
    </div>
</footer>

  <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <span class="copyright">Copyright &copy; Swarm Lab 2015</span>
                </div>
                <div class="col-md-4">
                    <ul class="list-inline social-buttons">
                        
                        <li><a href="https://twitter.com/sjmgarnier"><i class="fa fa-twitter"></i></a>
                        </li>
                        
                        <li><a href="https://plus.google.com/u/0/+SimonGarnier"><i class="fa fa-google-plus"></i></a>
                        </li>
                        
                        <li><a href="https://github.com/swarm-lab"><i class="fa fa-github"></i></a>
                        </li>
                        
                        <li><a href="https://www.linkedin.com/in/simongarnier"><i class="fa fa-linkedin"></i></a>
                        </li>
                        
                    </ul>
                </div>
                <div class="col-md-4">
                    <ul class="list-inline quicklinks">
                        <!--<li><a href="#">Privacy Policy</a>
                        </li>
                        <li><a href="#">Terms of Use</a>
                        </li>-->
                    </ul>
                </div>
            </div>
        </div>
    </footer>
 <!-- jQuery Version 1.11.0 -->
    <script src="/js/jquery-1.11.0.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="/js/jquery.easing.min.js"></script>
    <script src="/js/classie.js"></script>
    <script src="/js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="/js/jqBootstrapValidation.js"></script>
    <script src="/js/contact_me.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/js/agency.js"></script>


</body>
</html>
